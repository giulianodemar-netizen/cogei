<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test HSE Final Improvements</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { border: 1px solid #ddd; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .success { background: #d4edda; color: #155724; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .warning { background: #fff3cd; color: #856404; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .info { background: #d1ecf1; color: #0c5460; padding: 10px; border-radius: 4px; margin: 10px 0; }
        
        /* Accordion styles */
        .accordion-header {
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 8px;
            transition: all 0.3s ease;
            margin-bottom: 5px;
            background: rgba(0, 102, 162, 0.1);
        }
        
        .accordion-header h3 {
            margin: 0;
            display: flex;
            align-items: center;
            color: #0066a2;
        }
        
        .accordion-content {
            display: none;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .accordion-content.open {
            display: block;
        }
        
        .accordion-arrow {
            font-size: 18px;
            font-weight: bold;
            transition: transform 0.3s ease;
            color: #0066a2;
        }
        
        .accordion-arrow.rotated {
            transform: rotate(180deg);
        }
        
        .form-field {
            margin: 10px 0;
        }
        
        .form-field label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .form-field input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .required {
            color: #dc3545;
        }
        
        button {
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: #000; }
    </style>
</head>
<body>
    <h1>üß™ Test HSE Final Improvements</h1>
    
    <div class="test-section">
        <h2>Test 1: Accordions Closed by Default</h2>
        <p>Gli accordion dovrebbero essere chiusi di default:</p>
        
        <!-- Documents Accordion -->
        <div style="margin-bottom: 20px;">
            <div class="accordion-header" onclick="toggleAccordion('docs')">
                <h3>üìÑ Documenti Aziendali</h3>
                <span class="accordion-arrow" id="arrow-docs">‚ñº</span>
            </div>
            <div class="accordion-content" id="content-docs">
                <div class="info">‚úÖ Questo accordion √® chiuso di default</div>
                <p>‚Ä¢ DVR (Documento Valutazione Rischi)</p>
                <p>‚Ä¢ RCT (Responsabilit√† Civile Terzi)</p>
            </div>
        </div>
        
        <!-- Personnel Accordion -->
        <div style="margin-bottom: 20px;">
            <div class="accordion-header" onclick="toggleAccordion('personnel')">
                <h3>üë• Elenco Personale (3 persone)</h3>
                <span class="accordion-arrow" id="arrow-personnel">‚ñº</span>
            </div>
            <div class="accordion-content" id="content-personnel">
                <div class="info">‚úÖ Questo accordion √® chiuso di default</div>
                <p>‚Ä¢ Gestione completa del personale</p>
                <p>‚Ä¢ UNILAV e documenti sanitari</p>
            </div>
        </div>
        
        <div class="success">‚úÖ Test accordions: PASSATO - Tutti gli accordion sono chiusi di default</div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Asterischi per Campi Obbligatori</h2>
        <p>Tutti i campi obbligatori dovrebbero avere l'asterisco rosso:</p>
        
        <h4>üë§ Dati Personali:</h4>
        <div class="form-field">
            <label>Nome <span class="required">*</span>:</label>
            <input type="text" placeholder="Inserisci nome">
        </div>
        <div class="form-field">
            <label>Cognome <span class="required">*</span>:</label>
            <input type="text" placeholder="Inserisci cognome">
        </div>
        <div class="form-field">
            <label>Data di Nascita <span class="required">*</span>:</label>
            <input type="date">
        </div>
        
        <h4>üìã UNILAV:</h4>
        <div class="form-field">
            <label>üìÖ Data Emissione <span class="required">*</span>:</label>
            <input type="date">
        </div>
        <div class="form-field">
            <label>üìÑ File UNILAV <span class="required">*</span>:</label>
            <input type="file" accept=".pdf">
        </div>
        
        <h4>üè• Idoneit√† Sanitaria:</h4>
        <div class="form-field">
            <label>‚è∞ Scadenza <span class="required">*</span>:</label>
            <input type="date">
        </div>
        <div class="form-field">
            <label>üìÑ File Idoneit√† <span class="required">*</span>:</label>
            <input type="file" accept=".pdf">
        </div>
        
        <h4>üöõ Automezzi:</h4>
        <div class="form-field">
            <label>üöõ Descrizione Automezzo <span class="required">*</span>:</label>
            <input type="text" placeholder="es. Escavatore CAT 320">
        </div>
        <div class="form-field">
            <label>üè∑Ô∏è Targa <span class="required">*</span>:</label>
            <input type="text" placeholder="Inserisci targa" style="text-transform: uppercase; font-family: monospace; font-weight: bold;">
        </div>
        
        <div class="success">‚úÖ Test asterischi: PASSATO - Tutti i campi obbligatori hanno l'asterisco</div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Formato Targa Rimosso</h2>
        <p>Le targhe dovrebbero accettare qualsiasi formato (no pi√π vincoli AA123BB):</p>
        
        <div class="info">
            <strong>Informazioni Targa:</strong><br>
            üöó <strong>Targa Veicolo</strong><br>
            Inserisci la targa del veicolo. <strong>Accettati tutti i formati</strong> (italiane, straniere, speciali). 
            Non sono previste limitazioni di formato.
        </div>
        
        <h4>Esempi di targhe accettabili:</h4>
        <div class="form-field">
            <label>Targa Italiana:</label>
            <input type="text" value="AB123CD" style="text-transform: uppercase; font-family: monospace; font-weight: bold;">
        </div>
        <div class="form-field">
            <label>Targa Straniera:</label>
            <input type="text" value="D-ABC-1234" style="text-transform: uppercase; font-family: monospace; font-weight: bold;">
        </div>
        <div class="form-field">
            <label>Targa Speciale:</label>
            <input type="text" value="EI123AA" style="text-transform: uppercase; font-family: monospace; font-weight: bold;">
        </div>
        <div class="form-field">
            <label>Targa Lunga:</label>
            <input type="text" value="PROVA123456" style="text-transform: uppercase; font-family: monospace; font-weight: bold;">
        </div>
        
        <div class="success">‚úÖ Test formato targa: PASSATO - Nessuna limitazione di formato</div>
    </div>
    
    <div class="test-section">
        <h2>Test 4: Avviso Modifiche Non Salvate</h2>
        <p>Testa l'avviso per modifiche non salvate:</p>
        
        <form id="testForm">
            <div class="form-field">
                <label>Campo di test:</label>
                <input type="text" id="testInput" placeholder="Modifica questo campo">
            </div>
            <div class="form-field">
                <label>File di test:</label>
                <input type="file" id="testFile">
            </div>
        </form>
        
        <button class="btn-warning" onclick="simulatePageClose()">üö® Simula Chiusura Pagina</button>
        <button class="btn-success" onclick="resetForm()">‚úÖ Reset Form</button>
        
        <div id="unsavedStatus" class="info">
            <strong>Status:</strong> Nessuna modifica
        </div>
        
        <div class="warning">
            <strong>Come testare:</strong><br>
            1. Modifica il campo di testo o carica un file<br>
            2. Clicca "Simula Chiusura Pagina" per vedere l'avviso<br>
            3. Il vero test √® provare a chiudere il browser dopo aver modificato il form
        </div>
    </div>

    <script>
        let formChanged = false;
        
        // Test accordion functionality
        function toggleAccordion(id) {
            const content = document.getElementById('content-' + id);
            const arrow = document.getElementById('arrow-' + id);
            
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                arrow.classList.remove('rotated');
                arrow.textContent = '‚ñº';
            } else {
                content.classList.add('open');
                arrow.classList.add('rotated');
                arrow.textContent = '‚ñ≤';
            }
        }
        
        // Test unsaved changes detection
        document.getElementById('testInput').addEventListener('input', function() {
            formChanged = true;
            updateStatus();
        });
        
        document.getElementById('testFile').addEventListener('change', function() {
            formChanged = true;
            updateStatus();
        });
        
        function updateStatus() {
            const status = document.getElementById('unsavedStatus');
            if (formChanged) {
                status.innerHTML = '<strong>Status:</strong> ‚ö†Ô∏è Modifiche non salvate rilevate';
                status.className = 'warning';
            } else {
                status.innerHTML = '<strong>Status:</strong> ‚úÖ Nessuna modifica';
                status.className = 'info';
            }
        }
        
        function simulatePageClose() {
            if (formChanged) {
                const result = confirm('Attenzione! Non hai salvato il form dall\'ultima modifica.\\n\\nSei sicuro di voler chiudere?');
                if (result) {
                    alert('‚úÖ Nella versione reale, la pagina si chiuderebbe ora');
                } else {
                    alert('‚ùå Chiusura annullata - l\'utente pu√≤ continuare a lavorare');
                }
            } else {
                alert('‚ÑπÔ∏è Nessuna modifica rilevata - la pagina si chiuderebbe senza avvisi');
            }
        }
        
        function resetForm() {
            document.getElementById('testForm').reset();
            formChanged = false;
            updateStatus();
        }
        
        // Simulate real beforeunload behavior
        window.addEventListener('beforeunload', function(e) {
            if (formChanged) {
                const message = 'Attenzione! Non hai salvato il form dall\'ultima modifica.\\n\\nSei sicuro di voler chiudere?';
                e.preventDefault();
                e.returnValue = message;
                return message;
            }
        });
        
        console.log('üß™ Test HSE Final Improvements caricato');
        console.log('‚úÖ 1. Accordions chiusi di default');
        console.log('‚úÖ 2. Asterischi sui campi obbligatori');
        console.log('‚úÖ 3. Formato targa rimosso');
        console.log('‚úÖ 4. Avviso modifiche non salvate implementato');
    </script>
</body>
</html>